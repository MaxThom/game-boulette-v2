@page "/lobby/{gamecode}"
@inherits AppBaseComponent
@inject IJSRuntime js
@inject NavigationManager NavigationManager

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-16">
    <MudText Typo="Typo.h3" Align="Align.Center" GutterBottom="true"><strong>@LanguageManager.CurrentLanguage.CreateGamePage.Title</strong></MudText>
    <MudText Align="Align.Center">Hall d'entrée de '@GameCode'</MudText>

    <MudGrid Class="" Justify="Justify.Center">
        <MudItem xs="12" sm="12" md="12">
            <!--<MudPaper Class="d-flex pa-4 my-2 mud-text-align-center">-->
                <MudField Class="mx-4 mt-4 mb-n5" Label="Lien Url de la partie" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.ContentCopy" OnAdornmentClick="OnCopyGameUrl">localhost:5001/lobby/24f8bds34d=</MudField>
            <!--</MudPaper>-->
        </MudItem>
    </MudGrid>
    <MudGrid Class="mt-8" Justify="Justify.Center">        
        <MudItem xs="12" sm="6" md="6" >
            <MudPaper Elevation="25" Class="rounded-lg pb-4 mb-2 d-flex flex-column" Style="height:600px;">
                <MudItem Class="d-flex flex-row justify-start pt-5 pb-3 px-5">
                    <MudText Class="mt-1" style="font-size: 1em;" Typo="Typo.overline">Thème de la partie:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudText Class="my-auto" style="font-size: 1.5em;" Typo="Typo.body1"><strong>@game.GameTheme</strong></MudText>
                </MudItem>                
                <MudText Class="px-5" Typo="Typo.h6">Entrez vos mots</MudText>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #1:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #2:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #3:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #4:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #5:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #6:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #7:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start px-8"> 
                    <MudText Class="mt-3" style="font-size: 1em;" Typo="Typo.overline">Mot #8:&nbsp;&nbsp;&nbsp;</MudText>
                    <MudTextField Class="my-auto" Style="" @bind-Value="TeamNameOne" Variant="Variant.Text" />                     
                </MudItem>
                <MudItem Class="d-flex flex-row justify-end px-8 py-5 mt-auto">                     
                    <MudButton Variant="Variant.Outlined" Color="Color.Warning" Disabled="true" Class="pa-2 mr-2">Pas prêt</MudButton>
                    <MudButton Variant="Variant.Outlined" Color="Color.Success" Disabled="false" Class="pa-2 mr-2">Prêt</MudButton>
                    @if (IsHost)
                    {
                        <MudButton Variant="Variant.Outlined" Color="Color.Tertiary" Disabled="false" Class="pa-2">Lancer la partie !</MudButton>         
                    }
                </MudItem>
            </MudPaper>            
        </MudItem>
        <MudItem xs="12" sm="6" md="6">
            <MudItem Style="height:300px;">
                <MudItem Class="">
                    <MudPaper Elevation="25" Class="rounded-lg d-flex flex-row justify-start py-2 px-2">
                        @if (IsHost)
                        {
                            <MudTextField Class="my-auto" Style="width:250px;" @bind-Value="TeamNameOne" Label="Nom de l'équipe 1" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="OnTeamOneEdit" />
                        }
                        else 
                        {
                            <MudText Class="my-auto" Style="width:250px;" Typo="Typo.h6">@(TeamNameOne.Length > 10 ? TeamNameOne.Substring(0, 12) + " ..." : TeamNameOne)</MudText>
                        }
                        <MudButton Class="ml-2 my-2" Variant="Variant.Filled" Color="Color.Default" FullWidth="true">Rejoindre</MudButton>
                    </MudPaper>
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start flex-wrap py-2 px-1">
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Tertiary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Primary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Secondary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Warning">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Tertiary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Primary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Secondary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Warning">MaxThom</MudButton>
                </MudItem>
            </MudItem>
            <MudItem Style="height:300px;">
                <MudItem Class="">
                    <MudPaper Elevation="25" Class="rounded-lg d-flex flex-row justify-start py-2 px-2">
                        @if (IsHost)
                        {
                            <MudTextField Class="my-auto" Style="width:250px;" @bind-Value="TeamNameTwo" Label="Nom de l'équipe 2" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.Edit" OnAdornmentClick="OnTeamOneEdit" />
                        }
                        else 
                        {
                            <MudText Class="my-auto" Style="width:250px;" Typo="Typo.h6">@(TeamNameTwo.Length > 10 ? TeamNameTwo.Substring(0, 12) + " ..." : TeamNameTwo)</MudText>
                        }
                        <MudButton Class="ml-2 my-2" Variant="Variant.Filled" Color="Color.Default" FullWidth="true">Rejoindre</MudButton>
                    </MudPaper>
                </MudItem>
                <MudItem Class="d-flex flex-row justify-start flex-wrap py-2 px-1">
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Tertiary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Primary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Secondary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Warning">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Tertiary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Primary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Secondary">MaxThom</MudButton>
                    <MudButton Class="pa-2 ma-2" Variant="Variant.Filled" Color="Color.Warning">MaxThom</MudButton>
                </MudItem>
            </MudItem>
        </MudItem>
    </MudGrid>
    <MudGrid Class="" Justify="Justify.Center">
        <MudItem xs="12" sm="12" md="12">
            <MudPaper Class="d-flex pa-4 mud-text-align-center">
                <MudForm @ref="form" @bind-IsValid="@success" @bind-Errors="@errors" Class="d-flex flex-row justify-center flex-wrap py-1 px-1">
                    <MudTextField Class="pa-1 ma-1" T="string" ReadOnly="@(!IsHost)" Margin="Margin.Dense" @bind-Value="game.GameName" Label="@LanguageManager.CurrentLanguage.CreateGamePage.GameName" Variant="Variant.Outlined" Required="true" RequiredError="@LanguageManager.CurrentLanguage.CreateGamePage.MissingField" />
                    <MudTextField Class="pa-1 ma-1" T="string" ReadOnly="@(!IsHost)" Margin="Margin.Dense" @bind-Value="game.GameTheme" Label="@LanguageManager.CurrentLanguage.CreateGamePage.GameTheme" Variant="Variant.Outlined" />            
                    <MudNumericField Class="pa-1 ma-1" ReadOnly="@(!IsHost)" Margin="Margin.Dense" @bind-Value="game.NumberOfRound" Label="@LanguageManager.CurrentLanguage.CreateGamePage.NumberOfRound" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentText="@LanguageManager.CurrentLanguage.CreateGamePage.Rounds" Required="true" RequiredError="@LanguageManager.CurrentLanguage.CreateGamePage.MissingField"/> 
                    <MudNumericField Class="pa-1 ma-1" ReadOnly="@(!IsHost)" Margin="Margin.Dense" @bind-Value="game.TimePerTurn" Label="@LanguageManager.CurrentLanguage.CreateGamePage.TimePerTurn" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentText="@LanguageManager.CurrentLanguage.CreateGamePage.Seconds" Required="true" RequiredError="@LanguageManager.CurrentLanguage.CreateGamePage.MissingField"/>                        
                    <MudNumericField Class="pa-1 ma-1" ReadOnly="@(!IsHost)" Margin="Margin.Dense" @bind-Value="game.NumberOfPaper" Label="@LanguageManager.CurrentLanguage.CreateGamePage.NumberOfPaper" Variant="Variant.Outlined" Adornment="Adornment.End" AdornmentText="@LanguageManager.CurrentLanguage.CreateGamePage.Papers" Required="true" RequiredError="@LanguageManager.CurrentLanguage.CreateGamePage.MissingField"/>                        
                    <MudTextField T="string" Class="pa-1 ma-1" ReadOnly="@(!IsHost)" Margin="Margin.Dense" @bind-Value="game.VideoUrl" Label="@LanguageManager.CurrentLanguage.CreateGamePage.VideoURL" Variant="Variant.Outlined" />                        
                 </MudForm>                
            </MudPaper>
        </MudItem>
    </MudGrid>
    <MudGrid Class="" Justify="Justify.Center">
        <MudItem xs="12" sm="12" md="12">
            <MudButton Variant="Variant.Outlined" Color="Color.Tertiary"  Class="pa-2 ml-2 mr-auto">@LanguageManager.CurrentLanguage.CreateGamePage.Return</MudButton>
        </MudItem>
    </MudGrid>
</MudContainer>

@code {
    [Parameter]
    public string GameCode { get; set; }
    public bool IsHost { get; set; } = false;
    public string TeamNameOne { get; set; } = "Équipe #1wweqweqweqweqweqwe";
    public string TeamNameTwo { get; set; } = "Équipe #2";
    bool success;
    string[] errors = { };
    MudForm form;

    GameConfig game = new GameConfig()
    {
        GameName = "Partie de Bob",
        GameTheme = "Tout",
        NumberOfRound = 3,
        TimePerTurn = 60,
        NumberOfPaper = 5,      
        VideoUrl = "zoom.com/312dsd2g="
    };

    protected override void OnParametersSet()
    {
        GameCode = GameCode ?? "";
    }

    void OnTeamOneEdit()
    {
    }

    void OnTeamTwoEdit()
    {
    }

    void OnCopyGameUrl() 
    {
        Console.WriteLine("Copy");
    }
}
